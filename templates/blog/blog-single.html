{% extends 'base.html' %}
{% load humanize static blog_tags %}

{% block content %}
<!-- Start banner Area -->
<section class="relative about-banner">
    <div class="overlay overlay-bg"></div>
    <div class="container">
        <div class="row d-flex align-items-center justify-content-center">
            <div class="about-content col-lg-12 text-center">
                <h1 class="text-white">{{ posts.title }}</h1>
                <p class="text-white link-nav">
                    <a href="{% url 'website:home' %}">Home</a>
                    <span class="lnr lnr-arrow-right"></span>
                    <a href="{% url 'blog:index_blog' %}">Blog</a>
                    <span class="lnr lnr-arrow-right"></span>
                    {{ posts.title }}
                </p>
            </div>
        </div>
    </div>
</section>
<!-- End banner Area -->

<!-- Start post-content Area -->
<section class="post-content-area single-post-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 posts-list">
                <article class="single-post">
                    <div class="feature-img text-center">
                        <img class="img-fluid" src="{{ posts.image.url }}" alt="">
                    </div>
                    <div class="post-meta d-flex justify-content-between py-3">
                        <div>
                            <a href="{% url 'blog:author' author_username=posts.author.username %}"><i class="lnr lnr-user"></i> {{ posts.author }}</a>
                        </div>
                        <div>
                            <i class="lnr lnr-calendar-full"></i> {{ posts.created_date|naturaltime }}
                        </div>
                        <div>
                            <a href="{% url 'blog:post_map' posts.pk %}">مشاهده روی نقشه</a>

                        </div>
                        <div>
                            <i class="lnr lnr-bubble"></i> {{ comments|length }} Comments
                        </div>
                    </div>
                    <hr>
                    <h3 class="mb-20 post-title">{{ posts.title }}</h3>
                    <p class="excert post-content">{{ posts.content }}</p>
                </article>
                
                <!-- Comments Area -->
                <div class="comments-area">
                    <h4>{{ comments|length }} Comments</h4>
                    {% for comment in comments %}
                    <div class="comment-list d-flex">
                        <div class="thumb">
                            <img src="{{ comment.profile.image.url }}" alt="">
                        </div>
                        <div class="desc">
                            <h5>{{ comment.name }}</h5>
                            <p class="date">{{ comment.created_date|naturalday }}</p>
                            <p>{{ comment.message }}</p>
                        </div>
                    </div>
                    {% empty %}
                    <p>No comments here, be the first one...</p>
                    {% endfor %}
                </div>

                <!-- Comment Form -->
                 
                <div class="comment-form">
                    <h4>Leave a Comment</h4>
                    <form method="post" action="{% url "blog:single_blog" pk=posts.id %}">
                        {% csrf_token %}
                        <input type="hidden" name="post" value="{{ posts.id }}">
                        <div class="form-group">
                            <input type="text" class="form-control" name="name" placeholder="Enter Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" class="form-control" name="email" placeholder="Enter email address" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" name="subject" placeholder="Subject">
                        </div>
                        <div class="form-group">
                            <textarea class="form-control" rows="5" name="message" placeholder="Message" required></textarea>
                        </div>
                        <button type="submit" class="primary-btn text-uppercase">Post Comment</button>
                    </form>
                </div>
                
                <!-- Navigation Area After Comments -->
                <div class="navigation-area d-flex justify-content-between mt-4">
                    {% if prev_post %}
                    <div class="nav-left d-flex align-items-center prev-post-text">
                        <a href="{% url 'blog:single_blog' prev_post.pk %}">
                            <h4>پست قبلی: {{ prev_post.title }}</h4>
                            <img class="img-fluid prev-post-img" src="{{ prev_post.image.url }}" alt="">
                            
                        </a>
                    </div>
                    {% endif %}
                    
                    <!-- Next Post -->
                    {% if next_post %}
                    <div class="nav-right d-flex align-items-center next-post-text">
                        <a href="{% url 'blog:single_blog' next_post.pk %}">
                            <h4>پست بعدی:  {{ next_post.title }}</h4>
                            <img class="img-fluid next-post-img" src="{{ next_post.image.url }}" alt="">
                        </a>
                    </div>
                    {% endif %}
                    
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4 sidebar-widgets">
                <div class="widget-wrap">
                    <div class="single-sidebar-widget search-widget">
                        <form class="search-form" action="{% url 'blog:search' %}" method="get">
                            <input placeholder="Search Posts" name="s" type="text">
                            <button type="submit"><i class="fa fa-search"></i></button>
                        </form>
                    </div>
                    {% include 'blog/blog-writer.html' %}
                    {% latestposts %}
                    {% postcategories%}
                    {% include 'blog/blog-tags.html'%}
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End post-content Area -->
{% endblock %}
